#ifndef __TUBE_H__
#define __TUBE_H__
#include "wdfcircuits_triode.h"

typedef struct str_tubeFilter
{
    Triode v;
    TubeStageCircuit ckt;
    Real e;
    Real ci;
    Real ck;
    Real co;
    Real ro;
    Real rp;
    Real rg;
    Real ri;
	Real rk;
    Real overdrived1Gain;
    Real overdrived2Gain;
    Real   fConst0;
    Real   fConst1;
    Real   fConst2;
    Real   fConst3;
    Real   fRec0[4];
    Real   fRec1[4];
    Real   fRec2[4];
    Real   fRec3[4];
    Real   fRec4[4];
    Real   fRec5[4];
    Real   fRec6[4];
    Real   fRec7[4];
    Real   fRec8[4];
    Real   fRec9[4];
    Real   fRec10[4];
    Real   fRec11[4];
    Real   fRec12[4];
    Real   fRec13[4];
    Real   fConst4;
    Real   fConst5;
    Real   fRec14[4];
    Real   fConst6;
    Real   fRec15[4];
    Real   fRec16[4];
    Real   fRec17[4];
    Real   fRec18[4];
    Real   fRec19[4];
    Real   fRec20[4];
    Real   fRec21[4];
    Real   fRec22[4];
    Real   fRec23[4];
    Real   fRec24[4];
    Real toneStack0;
    Real toneStack1;
    Real toneStack2;
    Real toneStack3;
    Real toneStack4;
    Real toneStack5;
    Real toneStack6;
    Real toneStack7;
    Real toneStack8;
    Real toneStack9;
    Real toneStack10;
    Real toneStack11;
    Real toneStack12;
    Real toneStack13;
    Real toneStack14;
    Real toneStack15;
    Real toneStack16;
    Real toneStack17;
    Real toneStack18;
    Real toneStack19;
    Real toneStack20;
    Real toneStack21;
    Real toneStack22;
    Real toneStack23;
    Real toneStack24;
    Real toneStack25;
    Real toneStack26;
    Real toneStack27;
    Real toneStack28;
    Real toneStack29;
    Real toneStack30;
    int toneStack31;
    Real toneStack32;
    Real toneStack33;
    Real toneStack34;
    Real toneStack35;
    Real toneStack36;
    Real toneStack37;
    Real toneStack38;
    Real toneStack39;
    Real toneStack40;
    Real toneStack41;
    Real toneStack42;
    Real toneStack43;
    Real toneStack44;
    Real toneStack45;
    Real toneStack46;
    Real toneStack47;
    Real toneStack48;
    Real toneStack49;
    Real toneStack50;
    Real toneStack51;
    Real toneStack52;
    Real toneStack53;
    Real toneStack54;
    Real toneStack55;
    Real toneStack56;
    Real toneStack57;
    Real toneStack58;
    Real toneStack59;
    Real toneStack60;
    Real toneStack61;
    Real toneStack62;
    Real toneStack63;
    Real toneStack64;
    Real toneStack65;
    Real toneStack66;
    Real toneStack67;
    Real toneStack68;
    Real toneStack69;
    Real toneStack70;
    Real toneStack71;
    Real toneStack72;
    Real toneStack73;
    Real toneStack74;
    Real toneStack75;
    Real toneStack76;
    Real toneStack77;
    Real toneStack78;
    Real toneStack79;
    Real toneStack80;
    Real toneStack81;
    Real toneStack82;
    Real toneStack83;
    Real toneStack84;
    Real toneStack85;
    Real toneStack86;
    Real toneStack87;
    Real toneStack88;
    Real toneStack89;
    Real toneStack90;
    Real toneStack91;
    Real toneStack92;
    Real toneStack93;
    Real toneStack94;
    Real toneStack95;
    Real toneStack96;
    Real toneStack97;
    Real toneStack98;
    Real toneStack99;
    Real toneStack100;
    Real toneStack101;
    Real toneStack102;
    Real toneStack103;
    Real toneStack104;
    Real toneStack105;
    Real toneStack106;
    Real toneStack107;
    Real toneStack108;
    Real toneStack109;
    Real toneStack110;
    Real toneStack111;
    Real toneStack112;
    Real toneStack113;
    Real toneStack114;
    Real toneStack115;
    Real toneStack116;
    Real toneStack117;
    Real toneStack118;
    Real toneStack119;
    Real toneStack120;
    Real toneStack121;
    Real toneStack122;
    Real toneStack123;
    Real toneStack124;
    Real toneStack125;
    Real toneStack126;
    Real toneStack127;
    Real toneStack128;
    Real toneStack129;
    Real toneStack130;
    Real toneStack131;
    Real toneStack132;
    Real toneStack133;
    Real toneStack134;
    Real toneStack135;
    Real toneStack136;
    Real toneStack137;
    Real toneStack138;
    Real toneStack139;
    Real toneStack140;
    Real toneStack141;
    Real toneStack142;
    Real toneStack143;
    Real toneStack144;
    Real toneStack145;
    Real toneStack146;
    Real toneStack147;
    Real toneStack148;
    Real toneStack149;
    Real toneStack150;
    Real toneStack151;
    Real toneStack152;
    Real toneStack153;
    Real toneStack154;
    Real toneStack155;
    Real toneStack156;
    Real toneStack157;
    Real toneStack158;
    Real toneStack159;
    Real toneStack160;
    Real toneStack161;
    Real toneStack162;
    Real toneStack163;
    Real toneStack164;
    Real toneStack165;
    Real toneStack166;
    Real toneStack167;
    Real toneStack168;
    Real toneStack169;
    Real toneStack170;
    Real toneStack171;
    Real toneStack172;
    Real toneStack173;
    Real toneStack174;
    Real toneStack175;
    Real toneStack176;
    Real toneStack177;
    Real toneStack178;
    Real toneStack179;
    Real toneStack180;
    Real toneStack181;
    Real toneStack182;
    Real toneStack183;
    Real toneStack184;
    Real toneStack185;
    Real toneStack186;
    Real toneStack187;
    Real toneStack188;
    Real toneStack189;
    Real toneStack190;
    Real toneStack191;
    Real toneStack192;
    Real toneStack193;
    Real toneStack194;
    Real toneStack195;
    Real toneStack196;
    Real toneStack197;
    Real toneStack198;
    Real toneStack199;
    Real toneStack200;
    Real toneStack201;
    Real toneStack202;
    Real toneStack203;
    Real toneStack204;
    Real toneStack205;
    Real toneStack206;
    Real toneStack207;
    Real toneStack208;
    Real toneStack209;
    Real toneStack210;
    Real toneStack211;
    Real toneStack212;
    Real toneStack213;
    Real toneStack214;
    Real toneStack215;
    Real toneStack216;
    Real toneStack217;
    Real toneStack218;
    Real toneStack219;
    Real toneStack220;
    Real toneStack221;
    Real toneStack222;
    Real toneStack223;
    Real toneStack224;
    Real toneStack225;
    Real toneStack226;
    Real toneStack227;
    Real toneStack228;
    Real toneStack229;
    Real toneStack230;
    Real toneStack231;
    Real toneStack232;
    Real toneStack233;
    Real toneStack234;
    Real toneStack235;
    Real toneStack236;
    Real toneStack237;
    Real toneStack238;
    Real toneStack239;
    Real toneStack240;
    Real toneStack241;
    Real toneStack242;
    Real toneStack243;
    Real toneStack244;
    Real toneStack245;
    Real toneStack246;
    Real toneStack247;
    Real toneStack248;
    Real toneStack249;
    Real toneStack250;
    Real toneStack251;
    Real toneStack252;
    Real toneStack253;
    Real toneStack254;
    Real toneStack255;
    Real toneStack256;
    Real toneStack257;
    Real toneStack258;
    Real toneStack259;
    Real toneStack260;
    Real toneStack261;
    Real toneStack262;
    Real toneStack263;
    Real toneStack264;
    Real toneStack265;
    Real toneStack266;
    Real toneStack267;
    Real toneStack268;
    Real toneStack269;
    Real toneStack270;
    Real toneStack271;
    Real toneStack272;
    Real toneStack273;
    Real toneStack274;
    Real toneStack275;
    Real toneStack276;
    Real toneStack277;
    Real toneStack278;
    Real toneStack279;
    Real toneStack280;
    Real toneStack281;
    Real toneStack282;
    Real toneStack283;
    Real toneStack284;
    Real toneStack285;
    Real toneStack286;
    Real toneStack287;
    Real toneStack288;
    Real toneStack289;
    Real toneStack290;
    Real toneStack291;
    Real toneStack292;
    Real toneStack293;
    Real toneStack294;
    Real toneStack295;
    Real toneStack296;
    Real toneStack297;
    Real toneStack298;
    Real toneStack299;
    Real toneStack300;
    Real toneStack301;
    Real toneStack302;
    Real toneStack303;
    Real toneStack304;
    Real toneStack305;
    Real toneStack306;
    Real toneStack307;
    Real toneStack308;
    Real toneStack309;
    Real toneStack310;
    Real toneStack311;
    Real toneStack312;
    Real toneStack313;
    Real toneStack314;
    Real toneStack315;
    Real toneStack316;
    Real toneStack317;
    Real toneStack318;
    Real toneStack319;
    Real toneStack320;
    Real toneStack321;
    Real toneStack322;
    Real toneStack323;
    Real toneStack324;
    Real toneStack325;
    Real toneStack326;
    Real toneStack327;
    Real toneStack328;
    Real toneStack329;
    Real toneStack330;
    Real toneStack331;
    Real toneStack332;
    Real toneStack333;
    Real toneStack334;
    Real toneStack335;
    Real toneStack336;
    Real toneStack337;
    Real toneStack338;
    Real toneStack339;
    Real toneStack340;
    Real toneStack341;
    Real toneStack342;
    Real toneStack343;
    Real toneStack344;
    Real toneStack345;
    Real toneStack346;
    Real toneStack347;
    Real toneStack348;
    Real toneStack349;
    Real toneStack350;
    Real toneStack351;
    Real toneStack352;
    Real toneStack353;
    Real toneStack354;
    Real toneStack355;
    Real toneStack356;
    Real toneStack357;
    Real toneStack358;
    Real toneStack359;
    Real toneStack360;
    Real toneStack361;
    Real toneStack362;
    Real toneStack363;
    Real toneStack364;
    Real toneStack365;
    Real toneStack366;
    Real toneStack367;
    Real toneStack368;
    Real toneStack369;
    Real toneStack370;
    Real toneStack371;
    Real toneStack372;
    Real toneStack373;
    Real toneStack374;
    Real toneStack375;
    Real toneStack376;
    Real toneStack377;
    Real toneStack378;
    Real toneStack379;
    Real toneStack380;
    Real toneStack381;
    Real toneStack382;
    Real toneStack383;
    Real toneStack384;
    Real toneStack385;
    Real toneStack386;
    Real toneStack387;
    Real toneStack388;
    Real toneStack389;
    Real toneStack390;
    Real toneStack391;
    Real toneStack392;
    Real toneStack393;
    Real toneStack394;
    Real toneStack395;
    Real toneStack396;
    Real toneStack397;
    Real toneStack398;
    Real toneStack399;
    Real toneStack400;
    Real toneStack401;
    Real toneStack402;
    Real toneStack403;
    Real toneStack404;
    Real toneStack405;
    Real toneStack406;
    Real toneStack407;
    Real toneStack408;
    Real toneStack409;
    Real toneStack410;
    Real toneStack411;
    Real toneStack412;
    Real toneStack413;
    Real toneStack414;
    Real toneStack415;
    Real toneStack416;
    Real toneStack417;
    Real toneStack418;
    Real toneStack419;
    Real toneStack420;
    Real toneStack421;
    Real toneStack422;
    Real toneStack423;
    Real toneStack424;
    Real toneStack425;
    Real toneStack426;
    Real toneStack427;
    Real toneStack428;
    Real toneStack429;
    Real toneStack430;
    Real toneStack431;
    Real toneStack432;
    Real toneStack433;
    Real toneStack434;
    Real toneStack435;
    Real toneStack436;
    Real toneStack437;
    Real toneStack438;
    Real toneStack439;
    Real toneStack440;
    Real toneStack441;
    Real toneStack442;
    Real toneStack443;
    Real toneStack444;
    Real toneStack445;
    Real toneStack446;
    Real toneStack447;
    Real toneStack448;
    Real toneStack449;
    Real toneStack450;
    Real toneStack451;
    Real toneStack452;
    Real toneStack453;
    Real toneStack454;
    Real toneStack455;
    Real toneStack456;
    Real toneStack457;
    Real toneStack458;
    Real toneStack459;
    Real toneStack460;
    Real toneStack461;
    Real toneStack462;
    Real toneStack463;
    Real toneStack464;
    Real toneStack465;
    Real toneStack466;
    Real toneStack467;
    Real toneStack468;
    Real toneStack469;
    Real toneStack470;
    Real toneStack471;
    Real toneStack472;
    Real toneStack473;
    Real toneStack474;
    Real toneStack475;
    Real toneStack476;
    Real toneStack477;
    Real toneStack478;
    Real toneStack479;
    Real toneStack480;
    Real toneStack481;
    Real toneStack482;
    Real toneStack483;
    Real toneStack484;
    Real toneStack485;
    Real toneStack486;
    Real toneStack487;
    Real toneStack488;
    Real toneStack489;
    Real toneStack490;
    Real toneStack491;
    Real toneStack492;
    Real toneStack493;
    Real toneStack494;
    Real toneStack495;
    Real toneStack496;
    Real toneStack497;
    Real toneStack498;
    Real toneStack499;
    Real toneStack500;
    Real toneStack501;
    Real toneStack502;
    Real toneStack503;
    Real toneStack504;
    Real toneStack505;
    Real toneStack506;
    Real toneStack507;
    Real toneStack508;
    Real toneStack509;
    Real toneStack510;
    Real toneStack511;
    Real toneStack512;
    Real toneStack513;
    Real toneStack514;
    Real toneStack515;
    Real toneStack516;
    Real toneStack517;
    Real toneStack518;
    Real toneStack519;
    Real toneStack520;
    Real toneStack521;
    Real toneStack522;
    Real toneStack523;
    Real toneStack524;
    Real toneStack525;
    Real toneStack526;
    Real toneStack527;
    Real toneStack528;
    Real toneStack529;
    Real toneStack530;
    Real toneStack531;
    Real toneStack532;
    Real toneStack533;
    Real toneStack534;
    Real toneStack535;
    Real toneStack536;
    Real toneStack537;
    Real toneStack538;
    Real toneStack539;
    Real toneStack540;
    Real toneStack541;
    Real toneStack542;
    Real toneStack543;
    Real toneStack544;
    Real toneStack545;
    Real toneStack546;
    Real toneStack547;
    Real toneStack548;
    Real toneStack549;
    Real toneStack550;
    Real toneStack551;
    Real toneStack552;
    Real toneStack553;
    Real toneStack554;
    Real toneStack555;
    Real toneStack556;
    Real toneStack557;
    Real toneStack558;
    Real toneStack559;
    Real toneStack560;
    Real toneStack561;
    Real toneStack562;
    Real toneStack563;
    Real toneStack564;
    Real toneStack565;
    Real toneStack566;
    Real toneStack567;
    Real toneStack568;
    Real toneStack569;
    Real toneStack570;
    Real toneStack571;
    Real toneStack572;
    Real toneStack573;
    Real toneStack574;
    Real toneStack575;
    Real toneStack576;
    Real toneStack577;
    Real toneStack578;
    Real toneStack579;
    Real toneStack580;
    Real toneStack581;
    Real toneStack582;
    Real toneStack583;
    Real toneStack584;
    Real toneStack585;
    Real toneStack586;
    Real toneStack587;
    Real toneStack588;
    Real toneStack589;
    Real toneStack590;
    Real toneStack591;
    Real toneStack592;
    Real toneStack593;
    Real toneStack594;
    Real toneStack595;
    Real toneStack596;
    Real toneStack597;
    Real toneStack598;
    Real toneStack599;
    Real toneStack600;
    Real toneStack601;
    Real toneStack602;
    Real toneStack603;
    Real toneStack604;
    Real toneStack605;
    Real toneStack606;
    Real toneStack607;
    Real toneStack608;
    Real toneStack609;
    Real toneStack610;
    Real toneStack611;
    Real toneStack612;
    Real toneStack613;
    Real toneStack614;
    Real toneStack615;
    Real toneStack616;
    Real toneStack617;
    Real toneStack618;
    Real toneStack619;
    Real toneStack620;
    Real toneStack621;
    Real toneStack622;
    Real toneStack623;
    Real toneStack624;
    Real toneStack625;
    Real toneStack626;
    Real toneStack627;
    Real toneStack628;
    Real toneStack629;
    Real toneStack630;
    Real toneStack631;
    Real toneStack632;
    Real toneStack633;
    Real toneStack634;
    Real toneStack635;
    Real toneStack636;
    Real toneStack637;
    Real toneStack638;
    Real toneStack639;
    Real toneStack640;
    Real toneStack641;
    Real toneStack642;
    Real toneStack643;
    Real toneStack644;
    Real toneStack645;
    Real toneStack646;
    Real toneStack647;
    Real toneStack648;
    Real toneStack649;
    Real toneStack650;
    Real toneStack651;
    Real toneStack652;
    Real toneStack653;
    Real toneStack654;
    Real toneStack655;
    Real toneStack656;
    Real toneStack657;
    Real toneStack658;
    Real toneStack659;
    Real toneStack660;
    Real toneStack661;
    Real toneStack662;
    Real toneStack663;
    Real toneStack664;
	double pa0, pa1, pa2, pb0, pb1, pb2;
	double v1, v2;
} tubeFilter;
int InitTube(tubeFilter *tubefilter, double *circuitparameters, double samplerate, Real tubedrive, Real bass, Real middle, Real treble, Real tonestack, int warmupDuration, int insane);
void processTube(tubeFilter *tubefilter, Real* inputs, Real* outputs, unsigned frames);
#endif
