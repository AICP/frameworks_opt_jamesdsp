#ifndef __TUBE_H__
#define __TUBE_H__
#include "wdfcircuits_triode.h"
typedef struct str_tubeFilter
{
    Triode v;
    TubeStageCircuit ckt;
    Real e;
    Real ci;
    Real ck;
    Real co;
    Real ro;
    Real rp;
    Real rg;
    Real ri;
	Real rk;
    Real overdrived1Gain;
    Real overdrived2Gain;
    Real   fConst0;
    Real   fConst1;
    Real   fConst2;
    Real   fConst3;
    Real   fRec0[4];
    Real   fRec1[4];
    Real   fRec2[4];
    Real   fRec3[4];
    Real   fRec4[4];
    Real   fRec5[4];
    Real   fRec6[4];
    Real   fRec7[4];
    Real   fRec8[4];
    Real   fRec9[4];
    Real   fRec10[4];
    Real   fRec11[4];
    Real   fRec12[4];
    Real   fRec13[4];
    Real   fConst4;
    Real   fConst5;
    Real   fRec14[4];
    Real   fConst6;
    Real   fRec15[4];
    Real   fRec16[4];
    Real   fRec17[4];
    Real   fRec18[4];
    Real   fRec19[4];
    Real   fRec20[4];
    Real   fRec21[4];
    Real   fRec22[4];
    Real   fRec23[4];
    Real   fRec24[4];
	Real toneStack16;
	Real toneStack14;
	Real toneStack13;
	Real toneStack11;
	Real toneStack47;
	Real toneStack45;
	Real toneStack44;
	Real toneStack42;
	Real toneStack75;
	Real toneStack73;
	Real toneStack72;
	Real toneStack70;
	Real toneStack102;
	Real toneStack100;
	Real toneStack99;
	Real toneStack97;
	Real toneStack128;
	Real toneStack126;
	Real toneStack125;
	Real toneStack123;
	Real toneStack157;
	Real toneStack155;
	Real toneStack154;
	Real toneStack152;
	Real toneStack186;
	Real toneStack184;
	Real toneStack183;
	Real toneStack181;
	Real toneStack212;
	Real toneStack210;
	Real toneStack209;
	Real toneStack207;
	Real toneStack237;
	Real toneStack235;
	Real toneStack234;
	Real toneStack232;
	Real toneStack265;
	Real toneStack263;
	Real toneStack262;
	Real toneStack260;
	Real toneStack292;
	Real toneStack290;
	Real toneStack289;
	Real toneStack287;
	Real toneStack320;
	Real toneStack318;
	Real toneStack317;
	Real toneStack315;
	Real toneStack346;
	Real toneStack344;
	Real toneStack343;
	Real toneStack341;
	Real toneStack373;
	Real toneStack371;
	Real toneStack370;
	Real toneStack368;
	Real toneStack397;
	Real toneStack395;
	Real toneStack394;
	Real toneStack392;
	Real toneStack423;
	Real toneStack421;
	Real toneStack420;
	Real toneStack418;
	Real toneStack450;
	Real toneStack448;
	Real toneStack447;
	Real toneStack445;
	Real toneStack479;
	Real toneStack477;
	Real toneStack476;
	Real toneStack474;
	Real toneStack507;
	Real toneStack505;
	Real toneStack504;
	Real toneStack502;
	Real toneStack531;
	Real toneStack529;
	Real toneStack528;
	Real toneStack526;
	Real toneStack552;
	Real toneStack550;
	Real toneStack549;
	Real toneStack547;
	Real toneStack575;
	Real toneStack573;
	Real toneStack572;
	Real toneStack570;
	Real toneStack602;
	Real toneStack600;
	Real toneStack599;
	Real toneStack597;
	Real toneStack626;
	Real toneStack624;
	Real toneStack623;
	Real toneStack621;
	Real toneStack652;
	Real toneStack650;
	Real toneStack649;
	Real toneStack647;
	Real toneStack664;
	Real toneStack663;
	Real toneStack662;
	Real toneStack660;
	Real toneStack658;
	Real toneStack638;
	Real toneStack637;
	Real toneStack636;
	Real toneStack634;
	Real toneStack632;
	Real toneStack614;
	Real toneStack613;
	Real toneStack612;
	Real toneStack610;
	Real toneStack608;
	Real toneStack588;
	Real toneStack587;
	Real toneStack586;
	Real toneStack584;
	Real toneStack582;
	Real toneStack561;
	Real toneStack560;
	Real toneStack559;
	Real toneStack558;
	Real toneStack556;
	Real toneStack540;
	Real toneStack539;
	Real toneStack538;
	Real toneStack537;
	Real toneStack535;
	Real toneStack519;
	Real toneStack518;
	Real toneStack517;
	Real toneStack515;
	Real toneStack513;
	Real toneStack493;
	Real toneStack492;
	Real toneStack491;
	Real toneStack489;
	Real toneStack487;
	Real toneStack463;
	Real toneStack462;
	Real toneStack461;
	Real toneStack459;
	Real toneStack457;
	Real toneStack435;
	Real toneStack434;
	Real toneStack433;
	Real toneStack431;
	Real toneStack429;
	Real toneStack409;
	Real toneStack408;
	Real toneStack407;
	Real toneStack405;
	Real toneStack403;
	Real toneStack385;
	Real toneStack384;
	Real toneStack383;
	Real toneStack381;
	Real toneStack379;
	Real toneStack358;
	Real toneStack357;
	Real toneStack356;
	Real toneStack354;
	Real toneStack352;
	Real toneStack332;
	Real toneStack331;
	Real toneStack330;
	Real toneStack328;
	Real toneStack326;
	Real toneStack305;
	Real toneStack304;
	Real toneStack303;
	Real toneStack301;
	Real toneStack299;
	Real toneStack277;
	Real toneStack276;
	Real toneStack275;
	Real toneStack273;
	Real toneStack271;
	Real toneStack250;
	Real toneStack249;
	Real toneStack248;
	Real toneStack246;
	Real toneStack244;
	Real toneStack224;
	Real toneStack223;
	Real toneStack222;
	Real toneStack220;
	Real toneStack218;
	Real toneStack198;
	Real toneStack197;
	Real toneStack196;
	Real toneStack194;
	Real toneStack192;
	Real toneStack171;
	Real toneStack170;
	Real toneStack169;
	Real toneStack167;
	Real toneStack165;
	Real toneStack140;
	Real toneStack139;
	Real toneStack138;
	Real toneStack136;
	Real toneStack134;
	Real toneStack114;
	Real toneStack113;
	Real toneStack112;
	Real toneStack110;
	Real toneStack108;
	Real toneStack88;
	Real toneStack87;
	Real toneStack86;
	Real toneStack84;
	Real toneStack82;
	Real toneStack60;
	Real toneStack59;
	Real toneStack58;
	Real toneStack56;
	Real toneStack54;
	Real toneStack32;
	Real toneStack30;
	Real toneStack29;
	Real toneStack27;
	Real toneStack25;
	Real pa0, pa1, pa2, pb0, pb1, pb2;
	Real v1, v2;
} tubeFilter;
int InitTube(tubeFilter *tubefilter, Real *circuitparameters, Real samplerate, Real tubedrive, Real bass, Real middle, Real treble, int tonestack, int warmupDuration, int insane);
void processTube(tubeFilter *tubefilter, Real* inputs, Real* outputs, unsigned frames);
#endif